CREATE VIEW "CADIS"."IL_Investment_Research_Broker_Register" AS 
SELECT V."ResearchBrokerId" AS "Research Broker Id",V."BrokerCompanyName" AS "Broker Company Name",V."BloombergId" AS "Bloomberg Id", J3.DF AS "Broker Service Type",V."UnderCSAControl" AS "Under CSA Control?",V."ServiceCost" AS "Service Cost",V."ResearchCostWIMFundsPercent" AS "Research Cost WIM Funds Percentage",V."ResearchCostWIMLLPPercent" AS "Research Cost WIM LLP Percentage", J8.DF AS "Payment Frequency",V."PaymentTerms" AS "Payment Terms",V."ServiceDescription" AS "Service Description",V."InitialBudgetAmount" AS "Initial Budget Amount",V."InitialBudgetDate" AS "Initial Budget Date", J13.DF AS "Recorded By Person", J14.DF AS "Broker Relationship Person",V."ResearchAccountSalesforceId" AS "Research Account Salesforce Id",V."DocumentationFolderLink" AS "Documentation Folder Link",V."JoinGUID" AS "Join GUID",V."ResearchBrokerCreationDatetime" AS "Research Broker Creation Datetime",V."ResearchBrokerLastModifiedDatetime" AS "Research Broker Last Modified Datetime",V."IsActive" AS "IsActive" FROM "Investment"."ResearchBrokerRegister" V LEFT OUTER JOIN (SELECT DISTINCT "ServiceTypeId" AS JF,"ServiceType" AS DF FROM "Organisation"."BrokerServiceTypes")  J3 ON  J3.JF=V."BrokerServiceTypeId" LEFT OUTER JOIN (SELECT DISTINCT "PaymentFrequencyId" AS JF,"PaymentFrequency" AS DF FROM "Investment"."ResearchBrokerPaymentFrequency")  J8 ON  J8.JF=V."PaymentFrequencyId" LEFT OUTER JOIN (SELECT DISTINCT "PersonId" AS JF,"PersonsName" AS DF FROM "Core"."Persons")  J13 ON  J13.JF=V."RecordedByPersonId" LEFT OUTER JOIN (SELECT DISTINCT "PersonId" AS JF,"PersonsName" AS DF FROM "Core"."Persons")  J14 ON  J14.JF=V."BrokerRelationshipPersonId"
