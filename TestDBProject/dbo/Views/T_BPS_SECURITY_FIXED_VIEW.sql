CREATE VIEW [dbo].[T_BPS_SECURITY_FIXED_VIEW]
AS
SELECT [FILE_NAME], [DATE], [IDENTIFIER]
,CAST(NULL AS [datetime]) AS [ISSUE_DATE] 
	,CAST(NULL AS [datetime]) AS [MATURITY_DATE] 
	,CAST(NULL AS [decimal](26, 6)) AS  [COUPON_RATE] 
	,CAST(NULL AS [int]) AS   [COUPON_FREQUENCY]
	 ,CAST(NULL AS [varchar](30)) AS  [COUPON_TYPE]
	,CAST(NULL AS [varchar](1)) AS  [CONVERTIBLE_INDICATOR] 
	,CAST(NULL AS [decimal](26, 2)) AS  [AMOUNT_ISSUED] 
	,CAST(NULL AS [decimal](26, 2)) AS  [AMOUNT_OUTSTANDING] 
	,CAST(NULL AS [decimal](26, 6)) AS  [COUPON_CAP] 
	,CAST(NULL AS [varchar](3)) AS  [COUPON_ISO_CCY] 
	,CAST(NULL AS [decimal](26, 6)) AS  [COUPON_FLOOR] 
	,CAST(NULL AS [decimal](26, 6)) AS  [ISSUE_PRICE] 
	,CAST(NULL AS [int]) AS  [DAY_COUNT] 
	,CAST(NULL AS [datetime]) AS  [FIRST_COUPON_DATE]
	,CAST(NULL AS [datetime]) AS  [FIRST_SETTLE_DATE] 
	,CAST(NULL AS [datetime]) AS  [PREVIOUS_COUPON_DATE] 
	,CAST(NULL AS [datetime]) AS  [NEXT_COUPON_DATE] 
	,CAST(NULL AS [datetime]) AS  [NEXT_CALL_DATE] 
	,CAST(NULL AS [decimal](26, 6)) AS  [NEXT_CALL_PRICE] 
	,CAST(NULL AS [datetime]) AS  [LAST_RESET_DATE] 
	,CAST(NULL AS [datetime]) AS  [NEXT_RESET_DATE]
	,CAST(NULL AS [datetime]) AS  [SECOND_COUPON_DATE] 
	,CAST(NULL AS [varchar](1)) AS  [FIXED_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [FIX_TO_FLOAT_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [FLOATER_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [FLOAT_TO_FIX_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [INDEX_LINKED_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [INFLATION_LINKED_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [PERPETUAL_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [ZERO_COUPON_INDICATOR] 
	,CAST(NULL AS [decimal](26, 6)) AS  [ACCRUED_INTEREST_PER_100] 
	,CAST(NULL AS [datetime]) AS  [ACCRUED_INTEREST_DATE] 
	,CAST(NULL AS [varchar](30)) AS  [COLLATERAL_TYPE]
	,CAST(NULL AS [varchar](1)) AS  [AGGREGATE_AMOUNT_ISSUED_INDICATOR] 
	,CAST(NULL AS [decimal](26, 6)) AS  [ASSUMED_INDEX_VALUE] 
	,CAST(NULL AS [varchar](1)) AS  [BRADY_INDICATOR] 
	,CAST(NULL AS [int]) AS  [CALCULATION_TYPE] 
	,CAST(NULL AS [varchar](1)) AS  [CALLABLE_INDICATOR] 
	,CAST(NULL AS [varchar](1)) AS  [CALLED_INDICATOR] 
	,CAST(NULL AS [int]) AS  [CALL_DAYS_NOTICE] 
	,CAST(NULL AS [varchar](1)) AS  [PUTABLE_INDICATOR] 
	,CAST(NULL AS [int]) AS  [PUT_DAYS_NOTICE]
	,CAST(NULL AS [varchar](1)) AS  [CASH_SETTLED_INDICATOR]
	,CAST(NULL AS [decimal](26, 6)) AS  [CDS_RECOVERY_RATE] 
	,CAST(NULL AS [varchar](11)) AS  [CORPORATE_TO_EQUITY_TICKER] 
	,CAST(NULL AS [datetime]) AS  [FIX_TO_FLOAT_COUPON_TYPE_RESET_DATE]
	,CAST(NULL AS [varchar](1)) AS  [DEFAULTED_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [EXCHANGEABLE_INDICATOR]
	,CAST(NULL AS [varchar](30)) AS  [FLOATER_COUPON_CONVENTION]
	,CAST(NULL AS [int]) AS  [FLOATER_LOCKOUT_PERIOD]
	,CAST(NULL AS [varchar](30)) AS  [FLOATER_PAY_DAY]
	,CAST(NULL AS [varchar](1)) AS  [JUNIOR_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [SENIOR_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [REGULATION_S_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [SUBORDINATED_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [UNIT_TRADED_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [LOAN_PARTICIPATION_NOTE_INDICATOR]
	,CAST(NULL AS [varchar](4)) AS  [ORIGINAL_ISSUE_DISCOUNT_INDICATOR]
	,CAST(NULL AS [int]) AS  [GILT_DIGITS]
	,CAST(NULL AS [datetime]) AS  [GILTS_EX_DIVIDEND_DATE]
	,CAST(NULL AS [decimal](26, 6)) AS  [INDEX_RATIO_CPI]
	,CAST(NULL AS [decimal](26, 6)) AS  [MINIMUM_INCREMENT]
	,CAST(NULL AS [decimal](26, 6)) AS  [MINIMUM_PIECE]
	,CAST(NULL AS [decimal](26, 10)) AS  [MOST_RECENT_REPORTED_FACTOR]
	,CAST(NULL AS [decimal](26, 6)) AS  [MOST_RECENT_ACCRUAL_RATE]
	,CAST(NULL AS [datetime]) AS  [MOST_RECENT_ACCRUAL_RATE_START_DATE]
	,CAST(NULL AS [datetime]) AS  [MORTGAGE_DEAL_CALL_DATE]
	,CAST(NULL AS [datetime]) AS  [MORTGAGE_END_PRINCIPAL_WINDOW_MATURITY]
	,CAST(NULL AS [datetime]) AS  [MORTGAGE_FACTOR_DATE]
	,CAST(NULL AS [decimal](26, 6)) AS  [MORTGAGE_CURRENT_PAYMENT_RATE]
	,CAST(NULL AS [datetime]) AS  [MORTGAGE_FINAL_PAY_DATE]
	,CAST(NULL AS [datetime]) AS  [MORTGAGE_FIRST_PAY_DATE]
	,CAST(NULL AS [decimal](26, 2)) AS  [MORTGAGE_LIFE_FLOOR]
	,CAST(NULL AS [varchar](8)) AS  [MORTGAGE_PAYMENT_DELAY]
	,CAST(NULL AS [int]) AS  [MORTGAGE_RATE_CHANGE_FREQUENCY]
	,CAST(NULL AS [varchar](8)) AS  [MORTGAGE_TRANCHE_TYPE]
	,CAST(NULL AS [varchar](18)) AS  [MATURITY_REFUND_TYPE]
	,CAST(NULL AS [int]) AS  [NOMINAL_PAYMENT_DAY]
	,CAST(NULL AS [datetime]) AS  [PENULTIMATE_COUPON_DATE]
	,CAST(NULL AS [decimal](26, 6)) AS  [REDEMPTION_VALUE]
	,CAST(NULL AS [varchar](30)) AS  [UNDERLYING_REFERENCE_INDEX]
	,CAST(NULL AS [int]) AS  [RESET_FREQUENCY]
	,CAST(NULL AS [varchar](15)) AS  [RESET_INDEX] 
	,CAST(NULL AS [varchar](10)) AS  [SINK_TYPE]
	,CAST(NULL AS [varchar](1)) AS  [SINKABLE_INDICATOR]
	,CAST(NULL AS [decimal](26, 6)) AS  [STEPUP_STEPDOWN_COUPON]
	,CAST(NULL AS [datetime]) AS  [STEPUP_STEPDOWN_COUPON_DATE]
	,CAST(NULL AS [varchar](1)) AS  [STRUCTURED_NOTE_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [LOWER_TIER2_CAPITAL_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [TIER1_CAPITAL_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [TIER2_CAPITAL_NON_SPECIFIC_INDICATOR]
	,CAST(NULL AS [varchar](1)) AS  [UPPER_TIER2_CAPITAL_INDICATOR]
	,CAST(NULL AS [int]) AS  [EX_DIVIDEND_DAYS]
	,CAST(NULL AS [varchar](8)) AS  [EX_DIVIDEND_DAYS_CALENDAR_CODE]
	,CAST(NULL AS [varchar](6)) AS  [SUBORDINATE_TYPE]
	,CAST(NULL AS [varchar](5)) AS  [SENIORITY_LEVEL_2]
	,pvt.[CADIS_SYSTEM_UPDATED]
	FROM 
(SELECT [FILE_NAME]
      ,[DATE]
      ,[IDENTIFIER]
      ,[FIELD]
	  ,[VALUE]
	  ,[CADIS_SYSTEM_UPDATED]
FROM [dbo].[T_BPS_SECURITY]) p
PIVOT
(
	MIN([VALUE])
FOR [FIELD] IN
( 
	[ABCDE],
	[EFGHI]
 )
) AS pvt

